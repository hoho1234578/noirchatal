<%- navBar %>



<div id="shop_page" class="row-fluid">
	<table
		data-toggle="table"
		id="table"
		data-show-columns="true"
		data-search="true"
		data-show-pagination-switch="true"
		data-pagination="true"
		data-id-field="id"
		data-page-list="[10, 25, 50, 100, ALL]"
		data-show-footer="false"
		data-response-handler="responseHandler"
		>
	</table>
</div>


<script>
	var test = <%- JSON.stringify(cart) %>;
	console.log(test.dbCart);


	// access inner elements in the data source object
	// http://stackoverflow.com/questions/26084422/bootstrap-tables-how-to-access-inner-elements-in-the-data-source-object
	function responseHandler(res) {
        var flatArray = [];
        $.each(res, function(i, element) { 
            flatArray.push(JSON.flatten(element));
        });
        return flatArray;
    }


    function imageFormatter(value, row) {
    	// return '<div class="imgCell"><img src="/images/collections/'+value+'" /></div>';
    	return '<div class="imgCell"><div class="overlay" style="background-image:url(/images/collections/'+value+'); background-size: cover; background-position: 50%"></div></div>';
    }


	$('#table').bootstrapTable({
	    data: test.dbCart,
	    columns: [{
	        field: 'amount',
	        title: '數量',
	        sortable: true
	    }, {
	        field: 'price',
	        title: '單價',
	        sortable: true
	    }, {
	        field: 'item_img.0',
	        title: '圖示',
	        sortable: true,
	        formatter: "imageFormatter"
	    }, ]
	});
</script>